<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroRAG - ICD-10 Mental Health Diagnostic Assistant</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <div class="logo-icon">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M16 4C9.373 4 4 9.373 4 16s5.373 12 12 12 12-5.373 12-12S22.627 4 16 4zm0 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S6 21.523 6 16 10.477 6 16 6z" fill="currentColor"/>
                    <circle cx="12" cy="14" r="1.5" fill="currentColor"/>
                    <circle cx="20" cy="14" r="1.5" fill="currentColor"/>
                    <path d="M12 18c1 2 3 3 4 3s3-1 4-3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    <path d="M10 10c0-2 1-3 2-3M22 10c0-2-1-3-2-3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                </svg>
            </div>
            <div class="logo-text">
                <h2>NeuroRAG</h2>
                <span>Diagnostic Assistant</span>
            </div>
        </div>
        
        <nav class="nav-menu">
            <div class="nav-item active" onclick="showSection('dashboard')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                <span>Dashboard</span>
            </div>
            <div class="nav-item" onclick="showSection('database')">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                    <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path>
                    <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
                </svg>
                <span>Database</span>
            </div>
        </nav>
        
        <div class="sidebar-footer">
            <div class="version-info">
                <span class="version">v1.0.0</span>
                <span class="description">ICD-10 Chapter V</span>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header">
            <div class="header-title">
                <h1>Mental Health Diagnostics</h1>
                <p>Search ICD-10 codes and diagnostic criteria using AI</p>
            </div>
            <div class="status-badge" id="statusBadge">
                <span class="status-dot"></span>
                <span class="status-text">System Online</span>
            </div>
        </header>

        <!-- Dashboard Section -->
        <div id="dashboardSection" class="content-section">
            <!-- Dashboard Grid -->
            <div class="dashboard-grid">
            <!-- Search Card -->
            <div class="search-hero">
                <h2 class="search-title">Ask a Question</h2>
                <p class="search-subtitle">Search ICD-10 mental health diagnoses and diagnostic criteria</p>
                
                <div class="search-container">
                    <div class="search-box">
                        <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.35-4.35"></path>
                        </svg>
                        <input 
                            type="text" 
                            id="searchInput" 
                            placeholder="e.g., What is the code for recurrent depressive disorder?"
                            onkeypress="handleKeyPress(event)"
                            autocomplete="off"
                        >
                        <button id="searchBtn" onclick="performSearch()">
                            <span id="searchBtnText">Search</span>
                            <span id="searchLoader" class="loader" style="display: none;"></span>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                <polyline points="12 5 19 12 12 19"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="ai-toggle" style="margin-top: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                    <label for="aiToggle" style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                        <input type="checkbox" id="aiToggle" aria-label="Enable AI Mode" />
                        <span style="font-size: 0.95rem; color: var(--text-primary); font-weight: 600;">AI Mode</span>
                    </label>
                    <span style="font-size: 0.9rem; color: var(--text-secondary);">LLM-powered answers (may be slower)</span>
                </div>

                <div class="quick-examples">
                    <span class="examples-label">Quick examples:</span>
                    <div class="example-chips">
                        <button class="chip" onclick="setQuery('What is the code for Recurrent depressive disorder in remission?')">
                            Depression in remission
                        </button>
                        <button class="chip" onclick="setQuery('What are the diagnostic criteria for Obsessive-Compulsive Disorder?')">
                            OCD criteria
                        </button>
                        <button class="chip" onclick="setQuery('Tell me about bipolar disorder')">
                            Bipolar disorder
                        </button>
                        <button class="chip" onclick="setQuery('What is schizophrenia?')">
                            Schizophrenia
                        </button>
                        <button class="chip" onclick="setQuery('Anxiety disorders classification')">
                            Anxiety disorders
                        </button>
                        <button class="chip" onclick="setQuery('PTSD diagnosis')">
                            PTSD
                        </button>
                    </div>
                </div>
            </div>

            <!-- Stats Row -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon blue">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"></path>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-label">Vector Store</div>
                        <div class="stat-value" id="vectorStatus">Loading...</div>
                        <div class="stat-description">FAISS semantic index</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon green">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-label">Documents</div>
                        <div class="stat-value">ICD-10</div>
                        <div class="stat-description">Chapter V Mental Health</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon purple">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                            <line x1="8" y1="21" x2="16" y2="21"></line>
                            <line x1="12" y1="17" x2="12" y2="21"></line>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-label">AI Model</div>
                        <div class="stat-value">Falcon-1B</div>
                        <div class="stat-description">Language model + embeddings</div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon orange">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                    </div>
                    <div class="stat-content">
                        <div class="stat-label">Response Time</div>
                        <div class="stat-value">&lt;2s</div>
                        <div class="stat-description">Fast retrieval mode</div>
                    </div>
                </div>
            </div>

            <!-- Results Card (Hidden by default) -->
            <div class="results-container" id="resultsCard" style="display: none;">
                <div class="results-header">
                    <h3>Search Results</h3>
                    <button class="clear-btn" onclick="clearResults()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                        Clear
                    </button>
                </div>
                <div class="results-content" id="resultsContent">
                    <!-- Results will be dynamically inserted here -->
                </div>
            </div>

            <!-- Simplified Info Card -->
            <div class="card info-card">
                <h3>� About This Tool</h3>
                <p style="color: var(--text-secondary); line-height: 1.6;">
                    AI-powered assistant for ICD-10 mental health codes and diagnostic criteria. 
                    Ask questions in natural language and get instant, accurate answers.
                </p>
                
                <div style="margin-top: 1.5rem; padding: 1rem; background: var(--bg-light); border-radius: 8px; border-left: 3px solid var(--accent-green);">
                    <p style="margin: 0; color: var(--text-secondary); font-size: 0.875rem;">
                        <strong style="color: var(--primary-green);">100% Private</strong> • All data processed locally<br>
                        <strong style="color: var(--primary-green);">Lightning Fast</strong> • Instant semantic search<br>
                        <strong style="color: var(--primary-green);">Accurate</strong> • Official ICD-10 Chapter V data
                    </p>
                </div>
            </div>
        </div>

        <!-- Database Section -->
        <div id="databaseSection" class="content-section" style="display: none;">
            <div class="dashboard-grid">
                <div class="card" style="grid-column: 1 / -1;">
                    <h2 style="color: var(--primary-green); margin-bottom: 1.5rem;">📊 ICD-10 Database</h2>
                    <div class="database-controls">
                        <input 
                            type="text" 
                            id="dbSearch" 
                            placeholder="First load the database, then search..." 
                            style="flex: 1; padding: 0.75rem 1rem; border: 2px solid var(--border-color); border-radius: 8px; font-size: 0.95rem;"
                            onkeypress="if(event.key==='Enter') searchDatabase()"
                            disabled
                        >
                        <button 
                            onclick="searchDatabase()" 
                            style="padding: 0.75rem 1.5rem; background: var(--primary-green); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; margin-right: 0.5rem;">
                            Search
                        </button>
                        <button 
                            onclick="loadDatabase()" 
                            style="padding: 0.75rem 1.5rem; background: var(--accent-green); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
                            Load Data
                        </button>
                    </div>
                    <div id="databaseContent" class="database-content">
                        <p style="text-align: center; color: var(--text-secondary); padding: 3rem;">
                            Click "Load Data" to view the ICD-10 Mental Health database contents
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>
                Built by <strong>Gaurav Patil</strong> • 
                <a href="https://github.com/GauravPatil2515/NEURO-RAG" 
                   target="_blank" 
                   style="color: var(--accent-green); text-decoration: none;">
                    GitHub
                </a>
            </p>
        </footer>
    </main>

    <!-- Load JavaScript -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
